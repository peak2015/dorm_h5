(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aa16a8a4"],{"013f":function(e,t,i){var a=i("4ce5"),s=i("224c"),r=i("008a"),n=i("eafa"),o=i("5dd2");e.exports=function(e,t){var i=1==e,l=2==e,u=3==e,c=4==e,p=6==e,d=5==e||p,h=t||o;return function(t,o,f){for(var m,g,v=r(t),b=s(v),y=a(o,f,3),w=n(b.length),x=0,T=i?h(t,w):l?h(t,0):void 0;w>x;x++)if((d||x in b)&&(m=b[x],g=y(m,x,v),e))if(i)T[x]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return x;case 2:T.push(m)}else if(c)return!1;return p?-1:u||c?c:T}}},"0aed":function(e,t,i){"use strict";i("aaba");var a=i("bf16"),s=i("86d4"),r=i("238a"),n=i("f6b4"),o=i("cb3d"),l=i("8714"),u=o("species"),c=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),p=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();e.exports=function(e,t,i){var d=o(e),h=!r((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),f=h?!r((function(){var t=!1,i=/a/;return i.exec=function(){return t=!0,null},"split"===e&&(i.constructor={},i.constructor[u]=function(){return i}),i[d](""),!t})):void 0;if(!h||!f||"replace"===e&&!c||"split"===e&&!p){var m=/./[d],g=i(n,d,""[e],(function(e,t,i,a,s){return t.exec===l?h&&!s?{done:!0,value:m.call(t,i,a)}:{done:!0,value:e.call(i,t,a)}:{done:!1}})),v=g[0],b=g[1];a(String.prototype,e,v),s(RegExp.prototype,d,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},2346:function(e,t,i){var a=i("75c4");e.exports=Array.isArray||function(e){return"Array"==a(e)}},"2fd4":function(e,t,i){var a=i("fb68"),s=i("75c4"),r=i("cb3d")("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==s(e))}},5566:function(e,t,i){"use strict";var a=i("e2ee"),s=i.n(a);s.a},"5dd2":function(e,t,i){var a=i("81dc");e.exports=function(e,t){return new(a(e))(t)}},"6d57":function(e,t,i){for(var a=i("e44b"),s=i("80a9"),r=i("bf16"),n=i("e7ad"),o=i("86d4"),l=i("da6d"),u=i("cb3d"),c=u("iterator"),p=u("toStringTag"),d=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(h),m=0;m<f.length;m++){var g,v=f[m],b=h[v],y=n[v],w=y&&y.prototype;if(w&&(w[c]||o(w,c,d),w[p]||o(w,p,v),l[v]=d,b))for(g in a)w[g]||r(w,g,a[g],!0)}},7108:function(e,t,i){"use strict";var a=i("7e23"),s=RegExp.prototype.exec;e.exports=function(e,t){var i=e.exec;if("function"===typeof i){var r=i.call(e,t);if("object"!==typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(e))throw new TypeError("RegExp#exec called on incompatible receiver");return s.call(e,t)}},"7ee5":function(e,t){var i=function(e){if(this.params=e,this.setImageType(),this.params.justConversion)this.responseData();else{this.quality=1,this.minMultiple=1,this.depPreprocessingFile=null;var t=this;switch(this.params.quality||(this.params.quality=.3),this.params.requestType){case"base64":if(this.calculatedSize(this.params.res)<=1024*this.params.size)return this.responseData(this.params.res);this.depPreprocessingFile=this.params.res,this.checkAndHandleUpload();break;case"file":case"blob":if(this.params.res.size<1024*this.params.size)return this.responseData(this.params.res);this.fileToBase64(this.params.res,(function(e){t.depPreprocessingFile=e,t.checkAndHandleUpload()}));break}}};i.prototype.setImageType=function(){if(this.params.imgType)switch(this.params.requestType){case"base64":var e=this.params.res.split(","),t=e[0].match(/:(.*?);/)[1];this.params.res=this.params.res.replace(t,this.params.imgType);break;case"file":this.params.fileName||(this.params.fileName=this.params.res.name.slice(0,/\.{1}[a-z]{1,}$/.exec(this.params.res.name).index));case"blob":this.params.res.type=this.params.imgType;break}},i.prototype.responseData=function(e){var t=this,i=this.params.requestType,a=this.params.responseType;if(this.minMultiple>1&&(i="base64"),i!==a){var s=i+"To"+a.charAt(0).toUpperCase()+a.slice(1),r={base64ToFile:this.base64ToFile.bind(this),base64ToBlob:this.base64ToBlob.bind(this),fileToBase64:this.fileToBase64.bind(this),fileToBlob:this.fileToBlob.bind(this),blobToBase64:this.blobToBase64.bind(this),blobToFile:this.blobToFile.bind(this)};r[s](e||this.params.res,(function(e){t.params.callback(e)}))}else this.params.callback(e||this.params.res)},i.prototype.calculatedSize=function(e){var t="base64",i=e.substring(e.indexOf(t)+t.length),a=i.indexOf("=");i=-1!==a?i.substring(0,a):i;var s=i.length;return s-s/8*2},i.prototype.checkAndHandleUpload=function(){var e=this;try{var t=new Image;t.src=this.depPreprocessingFile,t.onload=function(){var i=document.createElement("canvas"),a=i.getContext("2d"),s=e.params.width||this.width;i.width=s,i.height=e.params.height||this.height*(s/this.width),a.clearRect(0,0,i.width,i.height),a.drawImage(t,0,0,i.width,i.height);var r=i.toDataURL("image/jpeg",e.quality),n=e.calculatedSize(r);if(e.minMultiple+=1,n<1024*e.params.size)e.responseData(r);else{if(!(e.quality>e.params.quality))return void e.responseData(r);if(1===e.quality&&(e.depPreprocessingFile=r),e.quality-=e.params.quality,e.minMultiple>25)return void e.responseData(r);e.checkAndHandleUpload()}}}catch(i){this.params.callback(null)}},i.prototype.base64ToFile=function(e,t){var i=e.split(","),a=i[0].match(/:(.*?);/)[1],s=a.split("/")[1],r=atob(i[1]),n=r.length,o=new Uint8Array(n);while(n--)o[n]=r.charCodeAt(n);t(new File([o],(this.params.fileName||"file")+"."+s,{type:a}))},i.prototype.base64ToBlob=function(e,t){var i=e.split(","),a="",s="";i.length>1&&(s=i[1],a=i[0].substring(i[0].indexOf(":")+1,i[0].indexOf(";")));for(var r=atob(s),n=new ArrayBuffer(r.length),o=new Uint8Array(n),l=0;l<r.length;l++)o[l]=r.charCodeAt(l);t(new Blob([n],{type:a}))},i.prototype.fileToBase64=function(e,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){t(this.result)}},i.prototype.fileToBlob=function(e,t){var i=this;this.fileToBase64(e,(function(e){i.base64ToBlob(e,(function(e){t(e)}))}))},i.prototype.blobToBase64=function(e,t){this.fileToBase64(e,t)},i.prototype.blobToFile=function(e,t){this.fileToBlob(e,(function(e){t(e)}))},e.exports=i},"81dc":function(e,t,i){var a=i("fb68"),s=i("2346"),r=i("cb3d")("species");e.exports=function(e){var t;return s(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!s(t.prototype)||(t=void 0),a(t)&&(t=t[r],null===t&&(t=void 0))),void 0===t?Array:t}},8714:function(e,t,i){"use strict";var a=i("f1fe"),s=RegExp.prototype.exec,r=String.prototype.replace,n=s,o="lastIndex",l=function(){var e=/a/,t=/b*/g;return s.call(e,"a"),s.call(t,"a"),0!==e[o]||0!==t[o]}(),u=void 0!==/()??/.exec("")[1],c=l||u;c&&(n=function(e){var t,i,n,c,p=this;return u&&(i=new RegExp("^"+p.source+"$(?!\\s)",a.call(p))),l&&(t=p[o]),n=s.call(p,e),l&&n&&(p[o]=p.global?n.index+n[0].length:t),u&&n&&n.length>1&&r.call(n[0],i,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(n[c]=void 0)})),n}),e.exports=n},8970:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("v-back",{attrs:{title:"上传图片"}}),i("div",{staticClass:"center",staticStyle:{"font-size":"4vw",padding:"2vw 0",color:"#1acfc6","font-weight":"bolder"}},[e._v(e._s(0==e.status?"":1==e.status?"待审核":2==e.status?"审核中...":3==e.status?"审核不通过":4==e.status?"图片错误":"审核通过"))]),i("div",{directives:[{name:"show",rawName:"v-show",value:3==e.status||4==e.status,expression:"status == 3 || status == 4"}],staticStyle:{"text-align":"center","padding-bottom":"2vw","font-size":"3.6vw"}},[e._v(e._s(3==e.status?e.unpass_reason:e.photo_error_msg))]),i("div",{staticClass:"scroll-view"},[i("md-field",[i("div",{staticClass:"md-field-item is-solid"},[i("div",{staticClass:"md-field-item-content",staticStyle:{padding:"0"}},[i("label",{staticClass:"md-field-item-title"},[e._v("* 图片")]),i("div",{staticClass:"md-field-item-control"},[i("ul",{staticClass:"image-reader-list"},[e._l(e.imageList["tupian"],(function(t,a){return i("li",{key:a,staticClass:"image-reader-item",style:{backgroundImage:"url("+t+")",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundSize:"cover"},on:{click:function(i){return e.imgsShow(t)}}},[0==e.status||3==e.status||4==e.status?i("md-tag",{staticClass:"image-reader-item-del",attrs:{size:"small",shape:"quarter","fill-color":"#111A34",type:"fill","font-color":"#fff"},nativeOn:{click:function(t){return t.stopPropagation(),e.onDeleteImage("tupian",a)}}},[i("md-icon",{attrs:{name:"close"}})],1):e._e()],1)})),i("li",{directives:[{name:"show",rawName:"v-show",value:0==e.imageList.tupian.length,expression:"imageList.tupian.length == 0"}],staticClass:"image-reader-item add"},[i("md-image-reader",{attrs:{name:"tupian"},on:{select:e.onReaderSelect,complete:e.onReaderComplete,error:e.onReaderError}}),i("md-icon",{attrs:{name:"camera",size:"md",color:"#CCC"}}),i("p",[e._v("添加图片")])],1)],2)])])]),i("md-input-item",{ref:"input0",attrs:{title:"姓名","is-amount":"",disabled:""},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),i("md-input-item",{ref:"input2",attrs:{title:"学号","is-amount":"",disabled:""},model:{value:e.user.usernbr,callback:function(t){e.$set(e.user,"usernbr",t)},expression:"user.usernbr"}})],1),0==e.status||3==e.status||4==e.status?i("md-field",[i("md-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.submit}},[e._v("提交")])],1):e._e()],1),i("md-image-viewer",{attrs:{list:e.imgs,"has-dots":!0},model:{value:e.isViewerShow,callback:function(t){e.isViewerShow=t},expression:"isViewerShow"}})],1)},s=[],r=(i("9a33"),i("cc57"),i("6d57"),i("ff21"),i("82ae")),n=i.n(r),o=i("7ee5"),l=i.n(o),u={name:"upload_index",data:function(){return{isViewerShow:!1,imgs:[],id:"",yellow_list_nbr:"",visitor_name:"",phone:"",remark:"",imageList:{tupian:[]},blob:null,file:{},user:JSON.parse(localStorage.getItem("user")),status:0,photo_error_msg:"",unpass_reason:""}},methods:{imgsShow:function(e){this.isViewerShow=!0,this.imgs=[e]},onReaderSelect:function(e,t){var i=t.files;i.forEach((function(e){console.log("[Mand Mobile] ImageReader Selected:","File Name "+e.name)})),this.$toast.loading("图片读取中...")},onReaderComplete:function(e,t){var i=this,a=t.dataUrl,s=t.blob,r=t.file;this.$toast.hide(),console.log("[Mand Mobile] ImageReader Complete:","File Name "+r.name),setTimeout((function(){var t=i.imageList[e]||[];t.push(a),i.$set(i.imageList,e,t),i.blob=s,i.file=r}),100)},onReaderError:function(e,t){var i=t.msg;this.$toast.failed(i)},onDeleteImage:function(e,t){var i=this.imageList[e]||[];i.splice(t,1),this.$set(this.imageList,e,i)},submit:function(){var e=this,t={user_nbr:this.user.usernbr,photo:this.visitor_photo,user_id:this.user.user_id,user_name:this.user.username};0==this.imageList.tupian.length?this.$toast.failed("请上传图片"):null==this.blob?this.updateStudent(t):(this.$toast.loading("图片上传中..."),new l.a({res:this.file,justConversion:!1,width:300,quality:.1,size:500,requestType:"file",responseType:"file",fileName:"yellow",callback:function(i){if(null!==i){var a=new FormData;a.append("file",i,(new Date).getTime()+"."+i.type.split("/")[1]),n.a.post("http://106.12.3.212/dorm/yellow/UploadImg/-1",a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(i){0==i.data.code?(e.visitor_photo=i.data.url,t.photo=i.data.url,setTimeout((function(){e.updateStudent(t)}),500)):e.$toast.failed("图片上传失败")})).catch((function(t){e.$toast.failed("图片上传失败")}))}else e.$toast.failed("图片上传失败")}}))},updateStudent:function(e){var t=this;this.$toast.loading("数据提交中..."),this.id&&(e.id=this.id),this.$post("/student_upload/add_update",e,(function(){t.$toast.succeed("提交成功"),setTimeout((function(){t.getStatusData()}),500)}))},getStatusData:function(){var e=this;this.$getL("/student_upload/find",{userId:this.user.user_id},(function(t){if(e.$toast.hide(),0==t.data.length)e.status=0;else{e.imageList.tupian=[t.data[0].photo],e.visitor_photo=t.data[0].photo,e.photo_error_msg=t.data[0].user.photo_error_msg,e.unpass_reason=t.data[0].unpass_reason;var i=t.data[0].check_status;if(e.id=t.data[0].id,"0"==i)e.status=1;else if("1"==i){var a=((new Date).getTime()-new Date(t.data[0].check_time).getTime())/36e5;a<.5?e.status=2:""==e.photo_error_msg?e.status=5:e.status=4}else"2"==i&&(e.status=3)}}))}},mounted:function(){this.getStatusData()}},c=u,p=(i("5566"),i("e90a")),d=Object(p["a"])(c,a,s,!1,null,"19c614b2",null);t["default"]=d.exports},"9a33":function(e,t,i){"use strict";var a=i("2fd4"),s=i("69b3"),r=i("f63e"),n=i("e754"),o=i("eafa"),l=i("7108"),u=i("8714"),c=i("238a"),p=Math.min,d=[].push,h="split",f="length",m="lastIndex",g=4294967295,v=!c((function(){RegExp(g,"y")}));i("0aed")("split",2,(function(e,t,i,c){var b;return b="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[f]||2!="ab"[h](/(?:ab)*/)[f]||4!="."[h](/(.?)(.?)/)[f]||"."[h](/()()/)[f]>1||""[h](/.?/)[f]?function(e,t){var s=String(this);if(void 0===e&&0===t)return[];if(!a(e))return i.call(s,e,t);var r,n,o,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,h=void 0===t?g:t>>>0,v=new RegExp(e.source,c+"g");while(r=u.call(v,s)){if(n=v[m],n>p&&(l.push(s.slice(p,r.index)),r[f]>1&&r.index<s[f]&&d.apply(l,r.slice(1)),o=r[0][f],p=n,l[f]>=h))break;v[m]===r.index&&v[m]++}return p===s[f]?!o&&v.test("")||l.push(""):l.push(s.slice(p)),l[f]>h?l.slice(0,h):l}:"0"[h](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,a){var s=e(this),r=void 0==i?void 0:i[t];return void 0!==r?r.call(i,s,a):b.call(String(s),i,a)},function(e,t){var a=c(b,e,this,t,b!==i);if(a.done)return a.value;var u=s(e),d=String(this),h=r(u,RegExp),f=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(v?"y":"g"),y=new h(v?u:"^(?:"+u.source+")",m),w=void 0===t?g:t>>>0;if(0===w)return[];if(0===d.length)return null===l(y,d)?[d]:[];var x=0,T=0,S=[];while(T<d.length){y.lastIndex=v?T:0;var _,L=l(y,v?d:d.slice(T));if(null===L||(_=p(o(y.lastIndex+(v?0:T)),d.length))===x)T=n(d,T,f);else{if(S.push(d.slice(x,T)),S.length===w)return S;for(var k=1;k<=L.length-1;k++)if(S.push(L[k]),S.length===w)return S;T=x=_}}return S.push(d.slice(x)),S}]}))},a2cd:function(e,t,i){"use strict";var a=i("238a");e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},aaba:function(e,t,i){"use strict";var a=i("8714");i("e46b")({target:"RegExp",proto:!0,forced:a!==/./.exec},{exec:a})},e2ee:function(e,t,i){},e754:function(e,t,i){"use strict";var a=i("fc81")(!0);e.exports=function(e,t,i){return t+(i?a(e,t).length:1)}},f1fe:function(e,t,i){"use strict";var a=i("69b3");e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},fc81:function(e,t,i){var a=i("ee21"),s=i("f6b4");e.exports=function(e){return function(t,i){var r,n,o=String(s(t)),l=a(i),u=o.length;return l<0||l>=u?e?"":void 0:(r=o.charCodeAt(l),r<55296||r>56319||l+1===u||(n=o.charCodeAt(l+1))<56320||n>57343?e?o.charAt(l):r:e?o.slice(l,l+2):n-56320+(r-55296<<10)+65536)}}},ff21:function(e,t,i){"use strict";var a=i("e46b"),s=i("013f")(0),r=i("a2cd")([].forEach,!0);a(a.P+a.F*!r,"Array",{forEach:function(e){return s(this,e,arguments[1])}})}}]);
//# sourceMappingURL=chunk-aa16a8a4.c21207ae.js.map